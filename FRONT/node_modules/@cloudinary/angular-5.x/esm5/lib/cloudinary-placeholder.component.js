/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, HostBinding, Input, ElementRef, Renderer2, } from '@angular/core';
import { Cloudinary } from './cloudinary.service';
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from './cloudinary.service';
var CloudinaryPlaceHolder = /** @class */ (function () {
    function CloudinaryPlaceHolder(cloudinary, renderer, el) {
        this.cloudinary = cloudinary;
        this.renderer = renderer;
        this.el = el;
        this.options = {};
    }
    /**
     * @param {?} width
     * @return {?}
     */
    CloudinaryPlaceHolder.prototype.setWidth = /**
     * @param {?} width
     * @return {?}
     */
    function (width) {
        this.itemWidth = width;
    };
    /**
     * @param {?} height
     * @return {?}
     */
    CloudinaryPlaceHolder.prototype.setHeight = /**
     * @param {?} height
     * @return {?}
     */
    function (height) {
        this.itemHeight = height;
    };
    /**
     * @param {?} id
     * @return {?}
     */
    CloudinaryPlaceHolder.prototype.setPublicId = /**
     * @param {?} id
     * @return {?}
     */
    function (id) {
        this.publicId = id;
    };
    /**
     * @return {?}
     */
    CloudinaryPlaceHolder.prototype.ngAfterContentChecked = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var imageTag = this.cloudinary.imageTag(this.publicId, this.options);
        this.setElementAttributes(this.el.nativeElement.children[0], imageTag.attributes());
        this.placeholderImg = this.getPlaceholderImage();
    };
    /**
     * @return {?}
     */
    CloudinaryPlaceHolder.prototype.getPlaceholderImage = /**
     * @return {?}
     */
    function () {
        if (this.type === 'predominant-color' && this.itemHeight && this.itemWidth) {
            return this.cloudinary.url(this.publicId, tslib_1.__assign({ placeholder: 'predominant-color-pixel' || true }, this.options));
        }
        else {
            return this.cloudinary.url(this.publicId, tslib_1.__assign({ placeholder: this.type || true }, this.options));
        }
    };
    /**
     * @param {?} element
     * @param {?} attributesLiteral
     * @return {?}
     */
    CloudinaryPlaceHolder.prototype.setElementAttributes = /**
     * @param {?} element
     * @param {?} attributesLiteral
     * @return {?}
     */
    function (element, attributesLiteral) {
        var _this = this;
        Object.keys(attributesLiteral).forEach(function (attrName) {
            if (attrName !== 'src' && attrName !== 'style') {
                _this.renderer.setAttribute(element, attrName, attributesLiteral[attrName]);
            }
        });
    };
    /** @nocollapse */
    CloudinaryPlaceHolder.ctorParameters = function () { return [
        { type: Cloudinary },
        { type: Renderer2 },
        { type: ElementRef }
    ]; };
    CloudinaryPlaceHolder.propDecorators = {
        type: [{ type: Input, args: ['type',] }],
        itemWidth: [{ type: HostBinding, args: ['style.width',] }],
        itemHeight: [{ type: HostBinding, args: ['style.height',] }],
        publicId: [{ type: HostBinding, args: ['attr.public-id',] }]
    };
CloudinaryPlaceHolder.ɵfac = function CloudinaryPlaceHolder_Factory(t) { return new (t || CloudinaryPlaceHolder)(ɵngcc0.ɵɵdirectiveInject(ɵngcc1.Cloudinary), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef)); };
CloudinaryPlaceHolder.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: CloudinaryPlaceHolder, selectors: [["cl-placeholder"]], hostVars: 5, hostBindings: function CloudinaryPlaceHolder_HostBindings(rf, ctx) { if (rf & 2) {
        ɵngcc0.ɵɵattribute("public-id", ctx.publicId);
        ɵngcc0.ɵɵstyleProp("width", ctx.itemWidth)("height", ctx.itemHeight);
    } }, inputs: { type: "type" }, decls: 1, vars: 1, consts: [[3, "src"]], template: function CloudinaryPlaceHolder_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelement(0, "img", 0);
    } if (rf & 2) {
        ɵngcc0.ɵɵproperty("src", ctx.placeholderImg, ɵngcc0.ɵɵsanitizeUrl);
    } }, encapsulation: 2 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(CloudinaryPlaceHolder, [{
        type: Component,
        args: [{
                selector: 'cl-placeholder',
                template: "<img [src]=\"this.placeholderImg\">"
            }]
    }], function () { return [{ type: ɵngcc1.Cloudinary }, { type: ɵngcc0.Renderer2 }, { type: ɵngcc0.ElementRef }]; }, { itemWidth: [{
            type: HostBinding,
            args: ['style.width']
        }], itemHeight: [{
            type: HostBinding,
            args: ['style.height']
        }], publicId: [{
            type: HostBinding,
            args: ['attr.public-id']
        }], type: [{
            type: Input,
            args: ['type']
        }] }); })();
    return CloudinaryPlaceHolder;
}());
export { CloudinaryPlaceHolder };
if (false) {
    /** @type {?} */
    CloudinaryPlaceHolder.prototype.type;
    /** @type {?} */
    CloudinaryPlaceHolder.prototype.itemWidth;
    /** @type {?} */
    CloudinaryPlaceHolder.prototype.itemHeight;
    /** @type {?} */
    CloudinaryPlaceHolder.prototype.publicId;
    /** @type {?} */
    CloudinaryPlaceHolder.prototype.options;
    /** @type {?} */
    CloudinaryPlaceHolder.prototype.placeholderImg;
    /**
     * @type {?}
     * @private
     */
    CloudinaryPlaceHolder.prototype.cloudinary;
    /**
     * @type {?}
     * @private
     */
    CloudinaryPlaceHolder.prototype.renderer;
    /**
     * @type {?}
     * @private
     */
    CloudinaryPlaceHolder.prototype.el;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2xvdWRpbmFyeS1wbGFjZWhvbGRlci5jb21wb25lbnQuanMiLCJzb3VyY2VzIjpbIkBjbG91ZGluYXJ5L2FuZ3VsYXItNS54L2xpYi9jbG91ZGluYXJ5LXBsYWNlaG9sZGVyLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFFTCxTQUFTLEVBQ1QsV0FBVyxFQUNYLEtBQUssRUFDTCxVQUFVLEVBQ1YsU0FBUyxHQUNWLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBQyxVQUFVLEVBQUMsTUFBTSxzQkFBc0IsQ0FBQzs7O0FBR2hEO0FBRWUsSUFZYiwrQkFBb0IsVUFBc0IsRUFBVSxRQUFtQixFQUFVLEVBQWM7QUFDakcsUUFEc0IsZUFBVSxHQUFWLFVBQVUsQ0FBWTtBQUFFLFFBQVEsYUFBUSxHQUFSLFFBQVEsQ0FBVztBQUFFLFFBQVEsT0FBRSxHQUFGLEVBQUUsQ0FBWTtBQUFFLFFBSGpHLFlBQU8sR0FBVyxFQUFFLENBQUM7QUFDdEIsSUFFbUcsQ0FBQztBQUVyRztBQUFTO0FBQ0s7QUFHYjtBQUFTLElBSlIsd0NBQVE7QUFBUTtBQUNLO0FBR2I7QUFBUyxJQUpqQixVQUFTLEtBQUs7QUFDZixRQUFHLElBQUksQ0FBQyxTQUFTLEdBQUcsS0FBSyxDQUFDO0FBQzFCLElBQUMsQ0FBQztBQUVGO0FBQVM7QUFDSTtBQUVkO0FBQ1EsSUFKTix5Q0FBUztBQUFRO0FBQ0k7QUFHZjtBQUFTLElBSmYsVUFBVSxNQUFNO0FBQ2pCLFFBQUcsSUFBSSxDQUFDLFVBQVUsR0FBRyxNQUFNLENBQUM7QUFDNUIsSUFBQyxDQUFDO0FBRUY7QUFBUztBQUNFO0FBR1Q7QUFBUyxJQUpWLDJDQUFXO0FBQ1o7QUFBc0I7QUFHVDtBQUFTLElBSnJCLFVBQVksRUFBRTtBQUNmLFFBQUcsSUFBSSxDQUFDLFFBQVEsR0FBRyxFQUFFLENBQUM7QUFDdEIsSUFBQyxDQUFDO0FBRUY7QUFBUztBQUNSO0FBQVMsSUFEVCxxREFBcUI7QUFDcEI7QUFBb0I7QUFBUyxJQUQ5QjtBQUFlO0FBQ0YsWUFBTCxRQUFRLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsT0FBTyxDQUFDO0FBQ3pFLFFBQUcsSUFBSSxDQUFDLG9CQUFvQixDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsYUFBYSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsRUFBRSxRQUFRLENBQUMsVUFBVSxFQUFFLENBQUMsQ0FBQztBQUN2RixRQUFHLElBQUksQ0FBQyxjQUFjLEdBQUcsSUFBSSxDQUFDLG1CQUFtQixFQUFFLENBQUM7QUFDcEQsSUFBQyxDQUFDO0FBRUY7QUFBUztBQUNOO0FBQVMsSUFEWCxtREFBbUI7QUFDbEI7QUFBb0I7QUFBUyxJQUQ5QjtBQUFlLFFBQ2IsSUFBSSxJQUFJLENBQUMsSUFBSSxLQUFLLG1CQUFtQixJQUFJLElBQUksQ0FBQyxVQUFVLElBQUksSUFBSSxDQUFDLFNBQVMsRUFBRTtBQUMvRSxZQUFLLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLFFBQVEscUJBQUcsV0FBVyxFQUFFLHlCQUF5QixJQUFJLElBQUksSUFBSyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUM7QUFDbEgsU0FBSTtBQUFFLGFBQUk7QUFDVixZQUFLLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLFFBQVEscUJBQUcsV0FBVyxFQUFFLElBQUksQ0FBQyxJQUFJLElBQUksSUFBSSxJQUFLLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQztBQUNsRyxTQUFJO0FBQ0osSUFBQyxDQUFDO0FBRUY7QUFBUztBQUEyQjtBQUNoQjtBQUFvQjtBQUFTLElBRGhELG9EQUFvQjtBQUFRO0FBQzFCO0FBQXFDO0FBQ3JDO0FBQVMsSUFGWCxVQUFxQixPQUFPLEVBQUUsaUJBQWlCO0FBQ2hELFFBREMsaUJBTUM7QUFDRixRQU5HLE1BQU0sQ0FBQyxJQUFJLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxPQUFPLENBQUMsVUFBQSxRQUFRO0FBQUssWUFDbEQsSUFBSSxRQUFRLEtBQUssS0FBSyxJQUFJLFFBQVEsS0FBSyxPQUFPLEVBQUU7QUFDckQsZ0JBQU8sS0FBSSxDQUFDLFFBQVEsQ0FBQyxZQUFZLENBQUMsT0FBTyxFQUFFLFFBQVEsRUFBRSxpQkFBaUIsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDO0FBQ2xGLGFBQU07QUFDTixRQUFHLENBQUMsQ0FBQyxDQUFDO0FBQ04sSUFBQyxDQUFDLENBM0NNO0FBQUU7a0NBTFYsU0FBUyxTQUFDLHBEQUt3QjtRQUpqQyxRQUFRLEVBQUUsbEJBTVQsZ0JBVkssVUFBVTtHQUlVLHVCQUMxQiwxQkFMcUIsZ0JBRnJCLFNBQVM7SUFPRCxFQUFFLE5BTlQsZ0JBRkQsVUFBVTtBQUNWO0VBTzZDLG1CQUU5QyxyQkFSRDtBQUNzQix1QkFTbkIsS0FBSyxTQUFDLE1BQU07QUFBUSw0QkFDcEIsV0FBVyxTQUFDLGFBQWE7QUFBUSw2QkFDakMsV0FBVyxTQUFDLGNBQWM7QUFBUSwyQkFDbEMsV0FBVyxTQUFDLGdCQUFnQjtBQUFPOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O29CQUV0QztBQUFFLElBc0NGLDRCQUFDO0FBQ0MsQ0FERCxBQWpERCxJQWlEQztBQUNBLFNBN0NZLHFCQUFxQjtBQUFLO0FBQWM7QUFDOUMsSUFBTCxxQ0FBNEI7QUFDN0I7QUFBc0IsSUFBckIsMENBQXNDO0FBQ3ZDO0FBQXNCLElBQXJCLDJDQUF3QztBQUN6QztBQUFzQixJQUFyQix5Q0FBd0M7QUFFMUM7QUFBc0IsSUFBcEIsd0NBQXFCO0FBQ3RCO0FBQXNCLElBQXJCLCtDQUF1QjtBQUV6QjtBQUFTO0FBQWtCO0FBQWlCO0FBQVMsSUFBdkMsMkNBQThCO0FBQUU7QUFBUztBQUFrQjtBQUFpQjtBQUFTLElBQXJELHlDQUEyQjtBQUFFO0FBQVM7QUFDcEY7QUFDZ0I7QUFDWCxJQUhzRSxtQ0FBc0I7O0FBekJBLEFBQUEsQUFFQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUdBLEFBY0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFIQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBR0EsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQ0EsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFNQSxBQUxBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBaERBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFFQSxBQVBBLEFBQUEsQUFGQSxBQUFBLEFBREEsQUFBQSxBQVlBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBd0NBLEFBQUEsQUFBQSxBQWpEQSxBQWlEQSxBQTVDQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUVBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQWZ0ZXJDb250ZW50Q2hlY2tlZCxcbiAgQ29tcG9uZW50LFxuICBIb3N0QmluZGluZyxcbiAgSW5wdXQsXG4gIEVsZW1lbnRSZWYsXG4gIFJlbmRlcmVyMixcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge0Nsb3VkaW5hcnl9IGZyb20gJy4vY2xvdWRpbmFyeS5zZXJ2aWNlJztcbmltcG9ydCB7IFNES0FuYWx5dGljc0NvbnN0YW50cyB9ICBmcm9tICcuL1NES0FuYWx5dGljc0NvbnN0YW50cyc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2NsLXBsYWNlaG9sZGVyJyxcbiAgdGVtcGxhdGU6IGA8aW1nIFtzcmNdPVwidGhpcy5wbGFjZWhvbGRlckltZ1wiPmBcbiAgLFxufSlcbmV4cG9ydCBjbGFzcyBDbG91ZGluYXJ5UGxhY2VIb2xkZXIgaW1wbGVtZW50cyBBZnRlckNvbnRlbnRDaGVja2VkIHtcbiAgQElucHV0KCd0eXBlJykgdHlwZTogc3RyaW5nO1xuICBASG9zdEJpbmRpbmcoJ3N0eWxlLndpZHRoJykgaXRlbVdpZHRoO1xuICBASG9zdEJpbmRpbmcoJ3N0eWxlLmhlaWdodCcpIGl0ZW1IZWlnaHQ7XG4gIEBIb3N0QmluZGluZygnYXR0ci5wdWJsaWMtaWQnKSBwdWJsaWNJZDtcblxuICBvcHRpb25zOiBvYmplY3QgPSB7fTtcbiAgcGxhY2Vob2xkZXJJbWc6IHN0cmluZztcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGNsb3VkaW5hcnk6IENsb3VkaW5hcnksIHByaXZhdGUgcmVuZGVyZXI6IFJlbmRlcmVyMiwgcHJpdmF0ZSBlbDogRWxlbWVudFJlZikge31cblxuICBzZXRXaWR0aCh3aWR0aCkge1xuICAgIHRoaXMuaXRlbVdpZHRoID0gd2lkdGg7XG4gIH1cblxuICBzZXRIZWlnaHQoaGVpZ2h0KSB7XG4gICAgdGhpcy5pdGVtSGVpZ2h0ID0gaGVpZ2h0O1xuICB9XG5cbiAgc2V0UHVibGljSWQoaWQpIHtcbiAgICB0aGlzLnB1YmxpY0lkID0gaWQ7XG4gIH1cblxuICBuZ0FmdGVyQ29udGVudENoZWNrZWQoKSB7XG4gICAgY29uc3QgaW1hZ2VUYWcgPSB0aGlzLmNsb3VkaW5hcnkuaW1hZ2VUYWcodGhpcy5wdWJsaWNJZCwgdGhpcy5vcHRpb25zKTtcbiAgICB0aGlzLnNldEVsZW1lbnRBdHRyaWJ1dGVzKHRoaXMuZWwubmF0aXZlRWxlbWVudC5jaGlsZHJlblswXSwgaW1hZ2VUYWcuYXR0cmlidXRlcygpKTtcbiAgICB0aGlzLnBsYWNlaG9sZGVySW1nID0gdGhpcy5nZXRQbGFjZWhvbGRlckltYWdlKCk7XG4gIH1cblxuICBnZXRQbGFjZWhvbGRlckltYWdlKCkge1xuICAgIGlmICh0aGlzLnR5cGUgPT09ICdwcmVkb21pbmFudC1jb2xvcicgJiYgdGhpcy5pdGVtSGVpZ2h0ICYmIHRoaXMuaXRlbVdpZHRoKSB7XG4gICAgICByZXR1cm4gdGhpcy5jbG91ZGluYXJ5LnVybCh0aGlzLnB1YmxpY0lkLCB7cGxhY2Vob2xkZXI6ICdwcmVkb21pbmFudC1jb2xvci1waXhlbCcgfHwgdHJ1ZSwgLi4udGhpcy5vcHRpb25zfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLmNsb3VkaW5hcnkudXJsKHRoaXMucHVibGljSWQsIHtwbGFjZWhvbGRlcjogdGhpcy50eXBlIHx8IHRydWUsIC4uLnRoaXMub3B0aW9uc30pO1xuICAgIH1cbiAgfVxuXG4gIHNldEVsZW1lbnRBdHRyaWJ1dGVzKGVsZW1lbnQsIGF0dHJpYnV0ZXNMaXRlcmFsKSB7XG4gICAgT2JqZWN0LmtleXMoYXR0cmlidXRlc0xpdGVyYWwpLmZvckVhY2goYXR0ck5hbWUgPT4ge1xuICAgICAgaWYgKGF0dHJOYW1lICE9PSAnc3JjJyAmJiBhdHRyTmFtZSAhPT0gJ3N0eWxlJykge1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnNldEF0dHJpYnV0ZShlbGVtZW50LCBhdHRyTmFtZSwgYXR0cmlidXRlc0xpdGVyYWxbYXR0ck5hbWVdKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuIl19